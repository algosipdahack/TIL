### 영속성 컨텍스트
- 1차 캐시
  - 1차 캐시에서 조회
  - 1차 캐시에 없을 시 DB에서 조회.
    - 조회 후 1차 캐시에 저장
- 동일성보장
- 변경감지
  - flush() 호출되는 시점에 발생
  - 스냅샷과 엔티티 비교
  - 엔티티의 모든 필드를 수정에 반영
    - 수정 쿼리를 미리 생성해두고 재사용
    - DB는 파싱된 쿼리를 재사용
- 지연로딩
- 쓰기지연
  - 쓰기지연 SQL저장소에 저장되었다가 한번에 DB에 날라간다.
  - 테이블 로우에 락이 걸리는 시간을 최소화

*스프링은 쓰레드마다 서로 다른 영속성 컨텍스트를 배정한다*
### 프록시
- 실제 클래스를 상속받아서 만들어지므로 실제 클래스와 겉 모양이 같음
  
- 트랜잭션과 영속성 컨텍스트의 생명주기가 같다.



### 준영속 상태와 변경감지
- 문제 해소 방법
  - 글로벌 페치 전략 수정
    - Eager로 도입
      - N+1문제 발생
  - 뷰가 필요한 엔티티를 미리 로딩
    - Facade계층을 추가해서 해당 계층에서 찾을 수 있게끔
  - OSIV(Open Session In View)
    - 문제점
      - 프레젠테이션 계층이 엔티티를 변경할 가능성이 존재

rabbitMQ -> 큐
아티텍처 > 헥사고날 +
MSA
신한은행
국민은행